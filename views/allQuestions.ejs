<!DOCTYPE html>
<html>
    <head>
        <link rel='stylesheet' href='/stylesheets/style.css' />
        <a href="/login" class="btn btn-primary my-2">Login</a>
        <a href="/signup" class="btn btn-primary my-2">Create Account</a>

        <script
            src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
            crossorigin="anonymous"
        ></script>
        <script>
            $(document).ready(function() {
                $(".myBtn").on('click', function() {
                    // $("#myModal").css('display', 'block');
                    // $(".modal").css('display', 'block');
                    alert($(this).prevAll('.id'));
                    $.ajax({
                        method: "GET",
                        url: "/question/retrieve/" + $(this).prevAll('.id').val(),
                        dataType: "json",
                        data: {
                            "id": $(this).prevAll('.id').val()
                        },
                        success: function(result, success) {
                            $("#authorName").html(`Hello`);
                            $("#bio").html(`Biography: <br> Hello there`);
                            $("#gen").html(`Gender: male`);
                            $('#authorModal').modal("show");
                        }
                    });

                });

                $(".close").on('click', function() {
                    // $("#myModal").css('display', 'none');
                    $(".modal").css('display', 'none');
                });

            });
        </script>
    </head>
    <body>
        <div>
            <h1>All the Questions</h1>
            <label>Create A Question!</label>
            <a href="/question/create">
                <button>New Question</button>
            </a>
            <br><br>
        </div>
        <table id="questionTable">
            <tr>
                <th>Language</th>
                <th>Topic</th>
                <th>Quesion</th>
                <th>Ratio</th>
                <th>Options</th>
            </tr>
            <% Questions.forEach(function(quest) { %>
                <input type="hidden" name="id" class="id" value="<%= quest._id %>">
                <tr>
                    <th><%= quest.language %></th>
                    <th><%= quest.topic %></th>
                    <th><%= quest.question %></th>
                    <th><%= quest.correct %>/<%= quest.attempts %> = <%= (quest.correct / quest.attempts) * 100 %>%</th>
                    <th>
                        <button>Edit</button>
                        <form action="/question/delete/<%= quest._id %>?_method=DELETE" method="POST">
                            <input type="hidden" name="_METHOD" value="DELETE">
                            <button id="item" class="item" name="item" value="<%= quest._id %>">Delete</button>
                        </form>
                        <button class="myBtn">Open Modal</button>
                    </th>
                    
                </tr>
            <% }); %>   
        </table>

        <div id="myModal" class="modal">
            <!-- Modal content -->
            <div class="modal-content">
                <span class="close">&times;</span>
            </div>
        </div>

            <!-- Modal -->
        <div class="modal fade" id="authorModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel"><h1 id="authorName"></h1></h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <span id="gen"></span>
                        <p id="bio"></p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        
    </body>
</html>